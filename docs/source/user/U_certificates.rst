.. _certificates:

TLS Certificates
================


Before any communtication is done with the KMEs, a client needs to have the proper certificates for authentication by the KME through mutual TLS authentication. 

Every certificate comes with the corresponding private key and the CA chain of the certificate. There are two ways to implement this: 

   1. The |QKDdc| issues a client certificate signed by the KME.
   2. The |admin| can install certificates issued by a specific root CA (or certificate chains belonging to the specified SAE).
   
For more information on the |QKDdc| role, refer to :ref:`Controller Overview <QKD_Controller>`

Method 1: KME-issued client certificate
---------------------------------------

The |QKDdc| can issue client certificates to SAEs through the KME. This requires the SAE to generate a certificate signing request (CSR), with the X.509 Subject fields specified according to the certificate policies set by the |QKDdc|. If no such policy exists, we recommend the following attributes for easier certificate management:

  #. CN - Common Name
  #. C - Country Name
  #. S - State or Province Name
  #. O - Organization Name
  #. OU - Organization Unit Name

The CSR can be generated from RSA or EC-based private keys.
The |QKDdc| is expected to return the issued certificate and CA chain for use by the SAE.

.. tip::

   As of 2021, a minimum key length of 2048-bit RSA or 256-bit ECC for client certificate signing is **strongly recommended**.

.. warning::

   The private key should be generated by the SAE and not shared with the |QKDdc| for security. While it is also possible for the |QKDdc| to generate a key-certificate pair and pass both directly to the client, this practice is not recommended.

Method 2: Install external certificates on KME
----------------------------------------------

The KME can alternatively authenticate individual SAE or groups of SAEs that do not belong to the KME certificate chain. This is achieved by the |admin| installing the certificate chain that is already available on the SAE into the KME. Other than providing the SAE's full certificate chain to the |admin|, no further action by the SAE is necessary.

----


.. |QKDdc| replace:: QKD device controller

.. |admin| replace:: Administrator
